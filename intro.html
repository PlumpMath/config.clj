<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>Usage</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Config</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1  current"><a href="intro.html"><div class="inner"><span>Usage</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>coldnew</span></div></div></li><li class="depth-2"><a href="coldnew.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-3"><a href="coldnew.config.impl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>impl</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#usage" name="usage"></a>Usage</h1>
<p>This library will look for <code>config.edn</code> file on the classpath or file defined with <code>config</code> environment variable. The contents of this file will be merged with the environment variables found in <code>System/getenv</code> and <code>System/getProperties</code>.</p>
<p>Letâ€™s create a simple testing project with following code, first add <code>config.edn</code> in <code>config/prod</code> and <code>config/dev</code> folder with setup like following:</p>
<pre><code class="clojure">{:db "jdbc:postgres://localhost/prod"}
</code></pre>
<p>And build our <code>project.clj</code></p>
<pre><code class="clojure">(defproject config-test "0.1.0-SNAPSHOT"
  :dependencies [[org.clojure/clojure "1.8.0"]
                 [coldnew/config "0.1.0-SNAPSHOT"]]
  :profiles {:prod {:resource-paths ["config/prod"]}
             :dev  {:resource-paths ["config/dev"]}}
  :main config-test.core)
</code></pre>
<p>Now you can add code in <code>src/config_test/core.clj</code> to print the variable we defined:</p>
<pre><code class="clojure">(ns config-test.core
  (:require [coldnew.config :refer [env conf]]))

(defn -main []
  (println (:db env))
  (println (:db conf)))
</code></pre>
<p>The application will print the <code>db</code> variable if it defined in environment variables or <code>config.edn</code> file. The different between <code>env</code> and <code>conf</code> function are the variables resolved order.</p>
<p><a href="https://coldnew.github.io/config.clj/coldnew.config.html#var-env">env</a> is resolved in the following order, the variables found in later will replace those declared earlier:</p>
<ol>
  <li><code>config.edn</code> on the classpath.</li>
  <li>EDN file specified using the <code>config</code> environment variable.</li>
  <li><code>.lein-env</code> file in the project directory.</li>
  <li><code>.boot-env</code> file in the project directory.</li>
  <li>Environment vairables.</li>
  <li>Java system propertirs.</li>
</ol>
<p><a href="https://coldnew.github.io/config.clj/coldnew.config.html#var-conf">conf</a> is like <code>env</code>, but with different priority:</p>
<ol>
  <li><code>.lein-env</code> file in the project directory.</li>
  <li><code>.boot-env</code> file in the project directory.</li>
  <li>Environment vairables.</li>
  <li>Java system propertirs.</li>
  <li><code>config.edn</code> on the classpath.</li>
  <li>EDN file specified using the <code>config</code> environment variable.</li>
</ol>
<p>If you want to use customize config.edn file, you can setup <code>config</code> environment variable.</p>
<p>For example, we can create a file called <code>custom-config.edn</code> that looks as follows:</p>
<pre><code class="clojure">{:db "jdbc:postgres://localhost/prod-custom"}
</code></pre>
<p>Then we start the app and pass it the <code>config</code> environment variable pointing to the location of the file:</p>
<pre><code class="clojure">java -Dconfig="custom-config.edn" -jar target/config-test.jar
=&gt; jdbc:postgres://localhost/prod-custom
</code></pre>
<p>or</p>
<pre><code class="clojure">CONFIG="custon-config.edn" java -jar target/config-test.jar
=&gt; jdbc:postgres://localhost/prod-custom
</code></pre>
<p>If you want your <code>config.edn</code> contains some function which need to be evaluated after load it, for example, your config.edn look like this:</p>
<pre><code class="clojure">{:foo (System/getenv "HOME")}
</code></pre>
<p>you can use <a href="https://coldnew.github.io/config.clj/coldnew.config.html#var-enable-eval.21">(enable-eval!)</a> to make this library evaluate file content:</p>
<pre><code class="clojure">(ns config-test.core
  (:require [coldnew.config :as conf]))

(conf/enable-eval!)    ; Make coldnew.config evaluate the config after load it

;; Following will print (System/getenv "HOME") result
(println (conf/env :foo))
(println (conf/conf :foo))
</code></pre></div></div></div></body></html>